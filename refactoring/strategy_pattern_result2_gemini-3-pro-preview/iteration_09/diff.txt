--- backup/classes\di_BindingParam.cls
+++ refactored/classes\di_BindingParam.cls
@@ -3,11 +3,5 @@
-@InvocableMethod(
-label='GetValue'
-)
-publicstaticList<Response>invoke(List<Request>requests){
-List<Response>responses=newList<Response>();
-for(Requestreq:requests){
-Responseres=newResponse();
-if(parameters!=null){
-Objectvalue=parameters.get(req.paramName);
-if(value!=null){
-if(valueinstanceofDecimal){
+privateinterfaceParamStrategy{
+voidexecute(Responseres,Objectvalue);
+}
+privateclassDecimalStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -21 +15,4 @@
-}elseif(valueinstanceofDecimal[]){
+}
+}
+privateclassDecimalArrayStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -31 +28,4 @@
-}elseif(valueinstanceofString){
+}
+}
+privateclassStringStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -39 +39,4 @@
-}elseif(valueinstanceofString[]){
+}
+}
+privateclassStringArrayStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -49 +52,4 @@
-}elseif(valueinstanceofBoolean){
+}
+}
+privateclassBooleanStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -57 +63,4 @@
-}elseif(valueinstanceofBoolean[]){
+}
+}
+privateclassBooleanArrayStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -67 +76,4 @@
-}elseif(valueinstanceofDate){
+}
+}
+privateclassDateStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -75 +87,4 @@
-}elseif(valueinstanceofDate[]){
+}
+}
+privateclassDateArrayStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -85 +100,4 @@
-}elseif(valueinstanceofDateTime){
+}
+}
+privateclassDateTimeStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -93 +111,4 @@
-}elseif(valueinstanceofDateTime[]){
+}
+}
+privateclassDateTimeArrayStrategyimplementsParamStrategy{
+publicvoidexecute(Responseres,Objectvalue){
@@ -103,0 +125,15 @@
+}
+privatestaticParamStrategygetStrategy(Objectvalue){
+if(valueinstanceofDecimal)returnnewDecimalStrategy();
+if(valueinstanceofDecimal[])returnnewDecimalArrayStrategy();
+if(valueinstanceofString)returnnewStringStrategy();
+if(valueinstanceofString[])returnnewStringArrayStrategy();
+if(valueinstanceofBoolean)returnnewBooleanStrategy();
+if(valueinstanceofBoolean[])returnnewBooleanArrayStrategy();
+if(valueinstanceofDate)returnnewDateStrategy();
+if(valueinstanceofDate[])returnnewDateArrayStrategy();
+if(valueinstanceofDateTime)returnnewDateTimeStrategy();
+if(valueinstanceofDateTime[])returnnewDateTimeArrayStrategy();
+returnnull;
+}
+privatestaticvoidnormalizeResponse(Responseres){
@@ -115,0 +152,15 @@
+}
+@InvocableMethod(
+label='GetValue'
+)
+publicstaticList<Response>invoke(List<Request>requests){
+List<Response>responses=newList<Response>();
+for(Requestreq:requests){
+Responseres=newResponse();
+if(parameters!=null){
+Objectvalue=parameters.get(req.paramName);
+if(value!=null){
+ParamStrategystrategy=getStrategy(value);
+if(strategy!=null){
+strategy.execute(res,value);
+}
@@ -121,0 +173 @@
+normalizeResponse(res);