--- backup/di_BindingParam.cls
+++ refactored/di_BindingParam.cls
@@ -0,0 +1,371 @@
+publicwithsharingclassdi_BindingParam{
+publicstaticMap<String,Object>parameters{get;set;}
+privateinterfaceParamStrategy{
+Responseexecute(Objectvalue,Requestreq);
+}
+privatestaticMap<Type,ParamStrategy>STRATEGIES=newMap<Type,ParamStrategy>{
+Decimal.class=>newDecimalStrategy(),
+Decimal[].class=>newDecimalArrayStrategy(),
+String.class=>newStringStrategy(),
+String[].class=>newStringArrayStrategy(),
+Boolean.class=>newBooleanStrategy(),
+Boolean[].class=>newBooleanArrayStrategy(),
+Date.class=>newDateStrategy(),
+Date[].class=>newDateArrayStrategy(),
+DateTime.class=>newDateTimeStrategy(),
+DateTime[].class=>newDateTimeArrayStrategy()
+};
+privatestaticclassDecimalStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+DecimaldecimalValue=(Decimal)value;
+res.longValue=toLongValue(decimalValue);
+res.decimalValue=decimalValue;
+res.stringValue=toStringValue(decimalValue);
+res.booleanValue=toBooleanValue(decimalValue);
+res.dateValue=toDateValue(decimalValue);
+res.dateTimeValue=toDateTimeValue(decimalValue);
+returnres;
+}
+}
+privatestaticclassDecimalArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+Decimal[]decimalValues=(Decimal[])value;
+res.decimalValues=decimalValues;
+for(DecimaldecimalValue:decimalValues){
+res.longValues.add(toLongValue(decimalValue));
+res.stringValues.add(toStringValue(decimalValue));
+res.booleanValues.add(toBooleanValue(decimalValue));
+res.dateValues.add(toDateValue(decimalValue));
+res.dateTimeValues.add(toDateTimeValue(decimalValue));
+}
+returnres;
+}
+}
+privatestaticclassStringStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+StringstringValue=(String)value;
+res.longValue=toLongValue(stringValue);
+res.decimalValue=toDecimalValue(stringValue);
+res.stringValue=stringValue;
+res.booleanValue=toBooleanValue(stringValue);
+res.dateValue=toDateValue(stringValue);
+res.dateTimeValue=toDateTimeValue(stringValue);
+returnres;
+}
+}
+privatestaticclassStringArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+String[]stringValues=(String[])value;
+res.stringValues=stringValues;
+for(StringstringValue:stringValues){
+res.longValues.add(toLongValue(stringValue));
+res.decimalValues.add(toDecimalValue(stringValue));
+res.booleanValues.add(toBooleanValue(stringValue));
+res.dateValues.add(toDateValue(stringValue));
+res.dateTimeValues.add(toDateTimeValue(stringValue));
+}
+returnres;
+}
+}
+privatestaticclassBooleanStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+BooleanbooleanValue=(Boolean)value;
+res.longValue=toLongValue(booleanValue);
+res.decimalValue=toDecimalValue(booleanValue);
+res.stringValue=toStringValue(booleanValue);
+res.booleanValue=booleanValue;
+res.dateValue=toDateValue(booleanValue);
+res.dateTimeValue=toDateTimeValue(booleanValue);
+returnres;
+}
+}
+privatestaticclassBooleanArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+Boolean[]booleanValues=(Boolean[])value;
+res.booleanValues=booleanValues;
+for(BooleanbooleanValue:booleanValues){
+res.longValues.add(toLongValue(booleanValue));
+res.decimalValues.add(toDecimalValue(booleanValue));
+res.stringValues.add(toStringValue(booleanValue));
+res.dateValues.add(toDateValue(booleanValue));
+res.dateTimeValues.add(toDateTimeValue(booleanValue));
+}
+returnres;
+}
+}
+privatestaticclassDateStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+DatedateValue=(Date)value;
+res.longValue=toLongValue(dateValue);
+res.decimalValue=toDecimalValue(dateValue);
+res.stringValue=toStringValue(dateValue);
+res.booleanValue=toBooleanValue(dateValue);
+res.dateValue=dateValue;
+res.dateTimeValue=toDateTimeValue(dateValue);
+returnres;
+}
+}
+privatestaticclassDateArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+Date[]dateValues=(Date[])value;
+res.dateValues=dateValues;
+for(DatedateValue:dateValues){
+res.longValues.add(toLongValue(dateValue));
+res.decimalValues.add(toDecimalValue(dateValue));
+res.stringValues.add(toStringValue(dateValue));
+res.booleanValues.add(toBooleanValue(dateValue));
+res.dateTimeValues.add(toDateTimeValue(dateValue));
+}
+returnres;
+}
+}
+privatestaticclassDateTimeStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+DateTimedateTimeValue=(DateTime)value;
+res.longValue=toLongValue(dateTimeValue);
+res.decimalValue=toDecimalValue(dateTimeValue);
+res.stringValue=toStringValue(dateTimeValue);
+res.booleanValue=toBooleanValue(dateTimeValue);
+res.dateValue=toDateValue(dateTimeValue);
+res.dateTimeValue=dateTimeValue;
+returnres;
+}
+}
+privatestaticclassDateTimeArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Objectvalue,Requestreq){
+Responseres=newResponse();
+DateTime[]dateTimeValues=(DateTime[])value;
+res.dateTimeValues=dateTimeValues;
+for(DateTimedateTimeValue:dateTimeValues){
+res.longValues.add(toLongValue(dateTimeValue));
+res.decimalValues.add(toDecimalValue(dateTimeValue));
+res.stringValues.add(toStringValue(dateTimeValue));
+res.booleanValues.add(toBooleanValue(dateTimeValue));
+res.dateValues.add(toDateValue(dateTimeValue));
+}
+returnres;
+}
+}
+@InvocableMethod(
+label='GetValue'
+)
+publicstaticList<Response>invoke(List<Request>requests){
+List<Response>responses=newList<Response>();
+for(Requestreq:requests){
+Responseres=newResponse();
+if(parameters!=null){
+Objectvalue=parameters.get(req.paramName);
+if(value!=null){
+TypevalueType=value.getClass();
+if(STRATEGIES.containsKey(valueType)){
+res=STRATEGIES.get(valueType).execute(value,req);
+}
+if(res.longValue==null&&!res.longValues.isEmpty()){
+res.longValue=res.longValues[0];
+}
+if(res.decimalValue==null&&!res.decimalValues.isEmpty()){
+res.decimalValue=res.decimalValues[0];
+}
+if(res.stringValue==null&&!res.stringValues.isEmpty()){
+res.stringValue=res.stringValues[0];
+}
+if(res.booleanValue==null&&!res.booleanValues.isEmpty()){
+res.booleanValue=res.booleanValues[0];
+}
+if(res.dateValue==null&&!res.dateValues.isEmpty()){
+res.dateValue=res.dateValues[0];
+}
+if(res.dateTimeValue==null&&!res.dateTimeValues.isEmpty()){
+res.dateTimeValue=res.dateTimeValues[0];
+}
+if(res.longValue!=null&&res.longValues.isEmpty()){
+res.longValues.add(res.longValue);
+}
+if(res.decimalValue!=null&&res.decimalValues.isEmpty()){
+res.decimalValues.add(res.decimalValue);
+}
+if(res.stringValue!=null&&res.stringValues.isEmpty()){
+res.stringValues.add(res.stringValue);
+}
+if(res.booleanValue!=null&&res.booleanValues.isEmpty()){
+res.booleanValues.add(res.booleanValue);
+}
+if(res.dateValue!=null&&res.dateValues.isEmpty()){
+res.dateValues.add(res.dateValue);
+}
+if(res.dateTimeValue!=null&&res.dateTimeValues.isEmpty()){
+res.dateTimeValues.add(res.dateTimeValue);
+}
+}else{
+System.debug(LoggingLevel.WARN,'BindingParam.parameters.get("'+req+'")isnull');
+}
+}else{
+System.debug(LoggingLevel.WARN,'BindingParam.parametersisnull');
+}
+System.debug('paramName='+req);
+System.debug(res);
+responses.add(res);
+}
+returnresponses;
+}
+privatestaticLongtoLongValue(Decimalvalue){
+return(value==null?null:value.longValue());
+}
+privatestaticLongtoLongValue(Stringvalue){
+return((value==null||!value.isNumeric())?null:Long.valueOf(value));
+}
+privatestaticLongtoLongValue(Booleanvalue){
+return(value==null?null:value?1:0);
+}
+privatestaticLongtoLongValue(Datevalue){
+return(value==null?null:toLongValue(
+DateTime.newInstance(value.year(),value.month(),value.day(),0,0,0)
+));
+}
+privatestaticLongtoLongValue(DateTimevalue){
+return(value==null?null:value.getTime());
+}
+privatestaticDecimaltoDecimalValue(Stringvalue){
+return((value==null||!value.isNumeric())?null:Decimal.valueOf(value));
+}
+privatestaticDecimaltoDecimalValue(Booleanvalue){
+return(value==null?null:value?1:0);
+}
+privatestaticDecimaltoDecimalValue(Datevalue){
+return(value==null?null:toDecimalValue(
+DateTime.newInstance(value.year(),value.month(),value.day(),0,0,0)
+));
+}
+privatestaticDecimaltoDecimalValue(DateTimevalue){
+return(value==null?null:value.getTime());
+}
+privatestaticStringtoStringValue(Datevalue){
+return(value==null?null:String.valueOf(value));
+}
+privatestaticStringtoStringValue(DateTimevalue){
+return(value==null?null:String.valueOf(value));
+}
+privatestaticStringtoStringValue(Objectvalue){
+return(value==null?null:String.valueOf(value));
+}
+privatestaticBooleantoBooleanValue(Decimalvalue){
+return(value==null?false:(value>0));
+}
+privatestaticBooleantoBooleanValue(Stringvalue){
+return(value==null?false:Boolean.valueOf(value));
+}
+privatestaticBooleantoBooleanValue(Datevalue){
+return(value==null?false:true);
+}
+privatestaticBooleantoBooleanValue(DateTimevalue){
+return(value==null?false:true);
+}
+privatestaticDatetoDateValue(Decimalvalue){
+return(value==null?null:DateTime.newInstance(value.longValue()).date());
+}
+privatestaticDatetoDateValue(Stringvalue){
+try{
+return(value==null?null:Date.valueOf(value));
+}catch(Exceptione){
+returnnull;
+}
+}
+privatestaticDatetoDateValue(Booleanvalue){
+returnnull;
+}
+privatestaticDatetoDateValue(DateTimevalue){
+return(value==null?null:value.date());
+}
+privatestaticDateTimetoDateTimeValue(Decimalvalue){
+return(value==null?null:DateTime.newInstance(value.longValue()));
+}
+privatestaticDateTimetoDateTimeValue(Stringvalue){
+try{
+return(value==null?null:DateTime.valueOf(value));
+}catch(Exceptione){
+returntoDateValue(value);
+}
+}
+privatestaticDateTimetoDateTimeValue(Booleanvalue){
+returnnull;
+}
+privatestaticDateTimetoDateTimeValue(Datevalue){
+return(value==null?null:DateTime.newInstance(value.year(),value.month(),value.day(),0,0,0));
+}
+publicclassRequest{
+@InvocableVariable(
+label='ParameterName',
+required=true
+)
+publicStringparamName;
+}
+publicclassResponse{
+@InvocableVariable(
+label='Number',
+description='Wholenumber(nodecimals)'
+)
+publicLonglongValue;
+@InvocableVariable(
+label='Decimal',
+description='Numberthatmayincludedecimalplaces'
+)
+publicDecimaldecimalValue;
+@InvocableVariable(
+label='Text',
+description='Textvalue'
+)
+publicStringstringValue;
+@InvocableVariable(
+label='Boolean',
+description='true/false'
+)
+publicBooleanbooleanValue;
+@InvocableVariable(
+label='Date'
+)
+publicDatedateValue;
+@InvocableVariable(
+label='Date/Time'
+)
+publicDateTimedateTimeValue;
+@InvocableVariable(
+label='NumberCollection',
+description='Collectionofwholenumbers'
+)
+publicLong[]longValues=newLong[]{};
+@InvocableVariable(
+label='DecimalCollection',
+description='Collectionofnumbersthatmayincludedecimalplaces'
+)
+publicDecimal[]decimalValues=newDecimal[]{};
+@InvocableVariable(
+label='TextCollection',
+description='Collectionoftextvalues'
+)
+publicString[]stringValues=newString[]{};
+@InvocableVariable(
+label='BooleanCollection',
+description='Collectionoftrue/falsevalues'
+)
+publicBoolean[]booleanValues=newBoolean[]{};
+@InvocableVariable(
+label='DateCollection',
+description='Collectionofdatevalues'
+)
+publicDate[]dateValues=newDate[]{};
+@InvocableVariable(
+label='Date/TimeCollection',
+description='Collectionofdate/timevalues'
+)
+publicDateTime[]dateTimeValues=newDateTime[]{};
+}
+}