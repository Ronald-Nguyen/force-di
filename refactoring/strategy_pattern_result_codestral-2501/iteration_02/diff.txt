--- backup/classes\di_BindingParam.cls
+++ refactored/classes\di_BindingParam.cls
@@ -3,12 +3,7 @@
-@InvocableMethod(
-label='GetValue'
-)
-publicstaticList<Response>invoke(List<Request>requests){
-List<Response>responses=newList<Response>();
-for(Requestreq:requests){
-Responseres=newResponse();
-if(parameters!=null){
-Objectvalue=parameters.get(req.paramName);
-if(value!=null){
-if(valueinstanceofDecimal){
-DecimaldecimalValue=(Decimal)value;
+privateinterfaceParamStrategy{
+Responseexecute(Requestreq);
+}
+privateclassDecimalStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+DecimaldecimalValue=(Decimal)di_BindingParam.parameters.get(req.paramName);
@@ -21,2 +16,7 @@
-}elseif(valueinstanceofDecimal[]){
-Decimal[]decimalValues=(Decimal[])value;
+returnres;
+}
+}
+privateclassDecimalArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+Decimal[]decimalValues=(Decimal[])di_BindingParam.parameters.get(req.paramName);
@@ -31,2 +31,7 @@
-}elseif(valueinstanceofString){
-StringstringValue=(String)value;
+returnres;
+}
+}
+privateclassStringStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+StringstringValue=(String)di_BindingParam.parameters.get(req.paramName);
@@ -39,2 +44,7 @@
-}elseif(valueinstanceofString[]){
-String[]stringValues=(String[])value;
+returnres;
+}
+}
+privateclassStringArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+String[]stringValues=(String[])di_BindingParam.parameters.get(req.paramName);
@@ -49,2 +59,7 @@
-}elseif(valueinstanceofBoolean){
-BooleanbooleanValue=(Boolean)value;
+returnres;
+}
+}
+privateclassBooleanStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+BooleanbooleanValue=(Boolean)di_BindingParam.parameters.get(req.paramName);
@@ -57,2 +72,7 @@
-}elseif(valueinstanceofBoolean[]){
-Boolean[]booleanValues=(Boolean[])value;
+returnres;
+}
+}
+privateclassBooleanArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+Boolean[]booleanValues=(Boolean[])di_BindingParam.parameters.get(req.paramName);
@@ -67,2 +87,7 @@
-}elseif(valueinstanceofDate){
-DatedateValue=(Date)value;
+returnres;
+}
+}
+privateclassDateStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+DatedateValue=(Date)di_BindingParam.parameters.get(req.paramName);
@@ -75,2 +100,7 @@
-}elseif(valueinstanceofDate[]){
-Date[]dateValues=(Date[])value;
+returnres;
+}
+}
+privateclassDateArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+Date[]dateValues=(Date[])di_BindingParam.parameters.get(req.paramName);
@@ -85,2 +115,7 @@
-}elseif(valueinstanceofDateTime){
-DateTimedateTimeValue=(DateTime)value;
+returnres;
+}
+}
+privateclassDateTimeStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+DateTimedateTimeValue=(DateTime)di_BindingParam.parameters.get(req.paramName);
@@ -93,2 +128,7 @@
-}elseif(valueinstanceofDateTime[]){
-DateTime[]dateTimeValues=(DateTime[])value;
+returnres;
+}
+}
+privateclassDateTimeArrayStrategyimplementsParamStrategy{
+publicResponseexecute(Requestreq){
+Responseres=newResponse();
+DateTime[]dateTimeValues=(DateTime[])di_BindingParam.parameters.get(req.paramName);
@@ -103,13 +143,65 @@
-}
-if(res.longValue==null&&!res.longValues.isEmpty()){res.longValue=res.longValues[0];}
-if(res.decimalValue==null&&!res.decimalValues.isEmpty()){res.decimalValue=res.decimalValues[0];}
-if(res.stringValue==null&&!res.stringValues.isEmpty()){res.stringValue=res.stringValues[0];}
-if(res.booleanValue==null&&!res.booleanValues.isEmpty()){res.booleanValue=res.booleanValues[0];}
-if(res.dateValue==null&&!res.dateValues.isEmpty()){res.dateValue=res.dateValues[0];}
-if(res.dateTimeValue==null&&!res.dateTimeValues.isEmpty()){res.dateTimeValue=res.dateTimeValues[0];}
-if(res.longValue!=null&&res.longValues.isEmpty()){res.longValues.add(res.longValue);}
-if(res.decimalValue!=null&&res.decimalValues.isEmpty()){res.decimalValues.add(res.decimalValue);}
-if(res.stringValue!=null&&res.stringValues.isEmpty()){res.stringValues.add(res.stringValue);}
-if(res.booleanValue!=null&&res.booleanValues.isEmpty()){res.booleanValues.add(res.booleanValue);}
-if(res.dateValue!=null&&res.dateValues.isEmpty()){res.dateValues.add(res.dateValue);}
-if(res.dateTimeValue!=null&&res.dateTimeValues.isEmpty()){res.dateTimeValues.add(res.dateTimeValue);}
+returnres;
+}
+}
+privatestaticMap<Type,ParamStrategy>STRATEGIES=newMap<Type,ParamStrategy>{
+Decimal.class=>newDecimalStrategy(),
+Decimal[].class=>newDecimalArrayStrategy(),
+String.class=>newStringStrategy(),
+String[].class=>newStringArrayStrategy(),
+Boolean.class=>newBooleanStrategy(),
+Boolean[].class=>newBooleanArrayStrategy(),
+Date.class=>newDateStrategy(),
+Date[].class=>newDateArrayStrategy(),
+DateTime.class=>newDateTimeStrategy(),
+DateTime[].class=>newDateTimeArrayStrategy()
+};
+@InvocableMethod(
+label='GetValue'
+)
+publicstaticList<Response>invoke(List<Request>requests){
+List<Response>responses=newList<Response>();
+for(Requestreq:requests){
+Responseres=newResponse();
+if(parameters!=null){
+Objectvalue=parameters.get(req.paramName);
+if(value!=null){
+TypevalueType=value.getClass();
+if(STRATEGIES.containsKey(valueType)){
+res=STRATEGIES.get(valueType).execute(req);
+}
+if(res.longValue==null&&!res.longValues.isEmpty()){
+res.longValue=res.longValues[0];
+}
+if(res.decimalValue==null&&!res.decimalValues.isEmpty()){
+res.decimalValue=res.decimalValues[0];
+}
+if(res.stringValue==null&&!res.stringValues.isEmpty()){
+res.stringValue=res.stringValues[0];
+}
+if(res.booleanValue==null&&!res.booleanValues.isEmpty()){
+res.booleanValue=res.booleanValues[0];
+}
+if(res.dateValue==null&&!res.dateValues.isEmpty()){
+res.dateValue=res.dateValues[0];
+}
+if(res.dateTimeValue==null&&!res.dateTimeValues.isEmpty()){
+res.dateTimeValue=res.dateTimeValues[0];
+}
+if(res.longValue!=null&&res.longValues.isEmpty()){
+res.longValues.add(res.longValue);
+}
+if(res.decimalValue!=null&&res.decimalValues.isEmpty()){
+res.decimalValues.add(res.decimalValue);
+}
+if(res.stringValue!=null&&res.stringValues.isEmpty()){
+res.stringValues.add(res.stringValue);
+}
+if(res.booleanValue!=null&&res.booleanValues.isEmpty()){
+res.booleanValues.add(res.booleanValue);
+}
+if(res.dateValue!=null&&res.dateValues.isEmpty()){
+res.dateValues.add(res.dateValue);
+}
+if(res.dateTimeValue!=null&&res.dateTimeValues.isEmpty()){
+res.dateTimeValues.add(res.dateTimeValue);
+}