--- backup/classes\di_BindingParam.cls
+++ refactored/classes\di_BindingParam.cls
@@ -127,0 +128,152 @@
+privateinterfaceValueConversionStrategy{
+Responseexecute(Objectvalue,Responseres);
+}
+privateclassDecimalConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+DecimaldecimalValue=(Decimal)value;
+res.longValue=toLongValue(decimalValue);
+res.decimalValue=decimalValue;
+res.stringValue=toStringValue(decimalValue);
+res.booleanValue=toBooleanValue(decimalValue);
+res.dateValue=toDateValue(decimalValue);
+res.dateTimeValue=toDateTimeValue(decimalValue);
+returnres;
+}
+}
+privateclassDecimalArrayConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+Decimal[]decimalValues=(Decimal[])value;
+res.decimalValues=decimalValues;
+for(DecimaldecimalValue:decimalValues){
+res.longValues.add(toLongValue(decimalValue));
+res.stringValues.add(toStringValue(decimalValue));
+res.booleanValues.add(toBooleanValue(decimalValue));
+res.dateValues.add(toDateValue(decimalValue));
+res.dateTimeValues.add(toDateTimeValue(decimalValue));
+}
+returnres;
+}
+}
+privateclassStringConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+StringstringValue=(String)value;
+res.longValue=toLongValue(stringValue);
+res.decimalValue=toDecimalValue(stringValue);
+res.stringValue=stringValue;
+res.booleanValue=toBooleanValue(stringValue);
+res.dateValue=toDateValue(stringValue);
+res.dateTimeValue=toDateTimeValue(stringValue);
+returnres;
+}
+}
+privateclassStringArrayConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+String[]stringValues=(String[])value;
+res.stringValues=stringValues;
+for(StringstringValue:stringValues){
+res.longValues.add(toLongValue(stringValue));
+res.decimalValues.add(toDecimalValue(stringValue));
+res.booleanValues.add(toBooleanValue(stringValue));
+res.dateValues.add(toDateValue(stringValue));
+res.dateTimeValues.add(toDateTimeValue(stringValue));
+}
+returnres;
+}
+}
+privateclassBooleanConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+BooleanbooleanValue=(Boolean)value;
+res.longValue=toLongValue(booleanValue);
+res.decimalValue=toDecimalValue(booleanValue);
+res.stringValue=toStringValue(booleanValue);
+res.booleanValue=booleanValue;
+res.dateValue=toDateValue(booleanValue);
+res.dateTimeValue=toDateTimeValue(booleanValue);
+returnres;
+}
+}
+privateclassBooleanArrayConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+Boolean[]booleanValues=(Boolean[])value;
+res.booleanValues=booleanValues;
+for(BooleanbooleanValue:booleanValues){
+res.longValues.add(toLongValue(booleanValue));
+res.decimalValues.add(toDecimalValue(booleanValue));
+res.stringValues.add(toStringValue(booleanValue));
+res.dateValues.add(toDateValue(booleanValue));
+res.dateTimeValues.add(toDateTimeValue(booleanValue));
+}
+returnres;
+}
+}
+privateclassDateConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+DatedateValue=(Date)value;
+res.longValue=toLongValue(dateValue);
+res.decimalValue=toDecimalValue(dateValue);
+res.stringValue=toStringValue(dateValue);
+res.booleanValue=toBooleanValue(dateValue);
+res.dateValue=dateValue;
+res.dateTimeValue=toDateTimeValue(dateValue);
+returnres;
+}
+}
+privateclassDateArrayConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+Date[]dateValues=(Date[])value;
+res.dateValues=dateValues;
+for(DatedateValue:dateValues){
+res.longValues.add(toLongValue(dateValue));
+res.decimalValues.add(toDecimalValue(dateValue));
+res.stringValues.add(toStringValue(dateValue));
+res.booleanValues.add(toBooleanValue(dateValue));
+res.dateTimeValues.add(toDateTimeValue(dateValue));
+}
+returnres;
+}
+}
+privateclassDateTimeConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+DateTimedateTimeValue=(DateTime)value;
+res.longValue=toLongValue(dateTimeValue);
+res.decimalValue=toDecimalValue(dateTimeValue);
+res.stringValue=toStringValue(dateTimeValue);
+res.booleanValue=toBooleanValue(dateTimeValue);
+res.dateValue=toDateValue(dateTimeValue);
+res.dateTimeValue=dateTimeValue;
+returnres;
+}
+}
+privateclassDateTimeArrayConversionStrategyimplementsValueConversionStrategy{
+publicResponseexecute(Objectvalue,Responseres){
+DateTime[]dateTimeValues=(DateTime[])value;
+res.dateTimeValues=dateTimeValues;
+for(DateTimedateTimeValue:dateTimeValues){
+res.longValues.add(toLongValue(dateTimeValue));
+res.decimalValues.add(toDecimalValue(dateTimeValue));
+res.stringValues.add(toStringValue(dateTimeValue));
+res.booleanValues.add(toBooleanValue(dateTimeValue));
+res.dateValues.add(toDateValue(dateTimeValue));
+}
+returnres;
+}
+}
+privatestaticMap<Type,ValueConversionStrategy>STRATEGIES=newMap<Type,ValueConversionStrategy>{
+Decimal.class=>newDecimalConversionStrategy(),
+Decimal[].class=>newDecimalArrayConversionStrategy(),
+String.class=>newStringConversionStrategy(),
+String[].class=>newStringArrayConversionStrategy(),
+Boolean.class=>newBooleanConversionStrategy(),
+Boolean[].class=>newBooleanArrayConversionStrategy(),
+Date.class=>newDateConversionStrategy(),
+Date[].class=>newDateArrayConversionStrategy(),
+DateTime.class=>newDateTimeConversionStrategy(),
+DateTime[].class=>newDateTimeArrayConversionStrategy()
+};
+privatestaticResponseprocessValue(Objectvalue,Responseres){
+TypevalueType=value.getClass();
+if(STRATEGIES.containsKey(valueType)){
+returnSTRATEGIES.get(valueType).execute(value,res);
+}
+returnres;
+}