--- backup/classes\di_Binding.cls
+++ refactored/classes\di_Binding.cls
@@ -28 +28,2 @@
-}elseif(newInstance==true){
+}
+if(newInstance==true){
@@ -30 +31,2 @@
-}elseif(Injected==null){
+}
+if(Injected==null){
@@ -102,26 +104,21 @@
-BooleanisMatch=false;
-if(String.isNotBlank(this.developerName)&&this.bindingObject!=null)
-{
-if((this.developerName.equalsIgnoreCase(bind.DeveloperName)
-||this.developerName.equalsIgnoreCase(di_NamespaceClass.CURRENTNAMESPACE+'.'+bind.DeveloperName)
-)
-&&this.bindingObject==bind.BindingObject)
-{
-isMatch=true;
-}
-}
-else{
-if(String.isNotBlank(this.developerName)
-&&(this.developerName.equalsIgnoreCase(bind.DeveloperName)
-||this.developerName.equalsIgnoreCase(di_NamespaceClass.CURRENTNAMESPACE+'.'+bind.DeveloperName)
-)
-)
-{
-isMatch=true;
-}
-elseif(this.bindingObject!=null&&bind.BindingObject==this.bindingObject)
-{
-isMatch=true;
-}
-}
-returnisMatch;
+BooleannameMatches=isNameMatch(bind);
+BooleanobjectMatches=isObjectMatch(bind);
+if(String.isNotBlank(this.developerName)&&this.bindingObject!=null){
+returnnameMatches&&objectMatches;
+}
+if(String.isNotBlank(this.developerName)){
+returnnameMatches;
+}
+if(this.bindingObject!=null){
+returnobjectMatches;
+}
+returnfalse;
+}
+privateBooleanisNameMatch(di_Bindingbind){
+if(String.isBlank(this.developerName))returnfalse;
+returnthis.developerName.equalsIgnoreCase(bind.DeveloperName)
+||this.developerName.equalsIgnoreCase(di_NamespaceClass.CURRENTNAMESPACE+'.'+bind.DeveloperName);
+}
+privateBooleanisObjectMatch(di_Bindingbind){
+if(this.bindingObject==null)returnfalse;
+returnbind.BindingObject==this.bindingObject;
@@ -131,2 +128 @@
-if(this.bindings==null)
-{
+if(this.bindings!=null)return;
@@ -138 +134,6 @@
-if(bind.BindingType==di_Binding.BindingType.Module){
+//GuardClause:Handlenon-Modulebindingsimmediately
+if(bind.BindingType!=di_Binding.BindingType.Module){
+this.bindings.add(bind);
+continue;
+}
+//HappyPath:HandleModulebindings
@@ -142,4 +142,0 @@
-}else{
-this.bindings.add(bind);
-}
-}
@@ -152,3 +149 @@
-if((di_PlatformCache.isStoringBindingInPlatformCache()&&bindingsAreRequired&&matchedBindings.isEmpty())
-||!di_PlatformCache.isStoringBindingInPlatformCache()
-)
+if(shouldLoadBindings(matchedBindings))
@@ -169,0 +165,6 @@
+}
+privateBooleanshouldLoadBindings(List<di_Binding>matchedBindings){
+if(!di_PlatformCache.isStoringBindingInPlatformCache()){
+returntrue;
+}
+returnbindingsAreRequired&&matchedBindings.isEmpty();
@@ -207,2 +208,4 @@
-if(ToinstanceofString)
-{
+if(!(ToinstanceofString))
+{
+returnTo;
+}
@@ -210 +213 @@
-TypetoType=NameSpacePrefix==null?Type.forName(className):Type.forName(NamespacePrefix,className);
+TypetoType=NamespacePrefix==null?Type.forName(className):Type.forName(NamespacePrefix,className);
@@ -221 +224 @@
-elseif(params!=null)
+if(params!=null)
@@ -227,2 +229,0 @@
-returnTo;
-}
@@ -234,2 +235,4 @@
-if(ToinstanceofString)
-{
+if(!(ToinstanceofString))
+{
+returnTo;
+}
@@ -250,2 +252,0 @@
-returnTo;
-}

--- backup/classes\di_PlatformCache.cls
+++ refactored/classes\di_PlatformCache.cls
@@ -54,6 +54,7 @@
-Booleanresult=false;
-if(isStoringBindingInPlatformCache())
-{
-Cache.OrgPartitionorgPartition=getPartition();
-if(orgPartition!=null)
-{
+if(!isStoringBindingInPlatformCache()){
+returnfalse;
+}
+Cache.OrgPartitionorgPartition=getPartition();
+if(orgPartition==null){
+returnfalse;
+}
@@ -77,4 +78 @@
-result=true;
-}
-}
-returnresult;
+returntrue;
@@ -85,4 +83,5 @@
-if(isStoringBindingInPlatformCache()
-&&string.isNotBlank(developerName)
-&&bindingSObjectType!=null)
-{
+//GuardClause1:Basicvalidation
+if(!isStoringBindingInPlatformCache()||String.isBlank(developerName)||bindingSObjectType==null)
+{
+returnbindings;
+}
@@ -90 +89,5 @@
-Cache.OrgPartitionorgPartition=getPartition();
+//GuardClause2:Partitionavailability
+Cache.OrgPartitionorgPartition=getPartition();
+if(orgPartition==null){
+returnbindings;
+}
@@ -92,2 +95,5 @@
-if(keyIndexBySObjectTypeMap!=null&&orgPartition!=null)
-{
+//GuardClause3:IndexMapcheck
+if(keyIndexBySObjectTypeMap==null)
+{
+returnbindings;
+}
@@ -95,2 +101,6 @@
-if(cacheKeys!=null)
-{
+//GuardClause4:CacheKeyscheck
+if(cacheKeys==null)
+{
+returnbindings;
+}
+//HappyPath
@@ -101,2 +111,5 @@
-if(cachedObject!=null)
-{
+//GuardClause5:Checkcachedobjectinsideloop
+if(cachedObject==null)
+{
+continue;
+}
@@ -104,4 +116,0 @@
-}
-}
-}
-}
@@ -213,2 +222,3 @@
-Stringkey=((bindingSObjectType!=null)?bindingSObjectType.getDescribe().getName().toLowerCase().replaceAll('__',''):'')
-+(String.isBlank(developerName)?'':developerName.toLowerCase().trim());
+StringobjectNamePart=(bindingSObjectType!=null)?bindingSObjectType.getDescribe().getName().toLowerCase().replaceAll('__',''):'';
+StringdevNamePart=String.isBlank(developerName)?'':developerName.toLowerCase().trim();
+Stringkey=objectNamePart+devNamePart;